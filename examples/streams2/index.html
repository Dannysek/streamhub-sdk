<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="/src/views/css/list-view.css">
    <link rel="stylesheet" type="text/css" href="/src/content/css/content.css">
    <style>
    #listView {
        width:500px;
    }
    </style>
    <script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
</head>
    <body>
        <div id="listView"></div>

        <script src="../../lib/requirejs/require.js" type="text/javascript"></script>
        <script src="/requirejs.conf.js" type="text/javascript"></script>
        <script>
        require([
            'jquery',
            'streamhub-sdk',
            'streamhub-sdk/views/list-view',
            'streamhub-sdk/streams/archive-state-stream'
        ],function ($, Hub, ListView, ArchiveStateStream) {
            var $el = $('#listView');

            /*var opts = {
                "network": "labs-t402.fyre.co",
                "siteId": "303827",
                "articleId": "labs_demo_fire",
                "environment": "t402.livefyre.com",
                highWaterMark: 200
            };*/
            var opts = {
                "network": "livefyre.com",
                "siteId": "4",
                "articleId": "584",
                highWaterMark: 200
            };
            
            var bss = new ArchiveStateStream(opts);
            window.numRead = 0;
            window.readableCount = 0;
            var MAX = 10000;
            bss.on('readable', function () {
                console.log('bss readable', window.readableCount++);
                var state;
                while ((window.numRead < MAX) && (state = bss.read())) {
                    window.numRead++;
                }
            });
            bss.on('error', function (err) {
                console.log('bss error', err);
            });
            bss.on('end', function () {
                console.log('bss end');
                debugger;
            });
            window.bss = bss
        });
        </script>
    </body>
</html>
